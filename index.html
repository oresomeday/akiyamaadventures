<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sマーダー工業高校サイコスリラー「ポールの呪い」</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1cm 0;
        }

        .game-container {
            width: 100%;
            max-width: 400px;
            min-height: 80vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 20px;
        }

        .title-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #ff6b6b;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: #ffa726;
        }

        .game-screen {
            display: none;
            flex-direction: column;
            justify-content: center;
        }

        .story-area {
            background: rgba(0,0,0,0.7);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 200px;
            border: 2px solid #444;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .character-name {
            color: #4fc3f7;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .story-text {
            line-height: 1.6;
            font-size: 1rem;
            margin-bottom: 15px;
            flex-grow: 1;
            display: flex;
            align-items: center;
        }

        .choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .choice-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            padding: 15px;
            border-radius: 8px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .choice-btn:hover {
            background: linear-gradient(45deg, #764ba2, #667eea);
            border-color: #fff;
            transform: translateY(-2px);
        }

        .start-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .start-btn:hover {
            background: linear-gradient(45deg, #ee5a24, #ff6b6b);
            transform: scale(1.05);
        }

        .next-btn {
            background: linear-gradient(45deg, #26de81, #20bf6b);
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 15px;
            align-self: center;
        }

        .death-scene {
            background: linear-gradient(135deg, #c0392b, #8e44ad);
            color: #fff;
            text-align: center;
            animation: pulse 2s infinite;
        }

        .happy-ending {
            background: linear-gradient(135deg, #26de81, #20bf6b);
            color: #fff;
            text-align: center;
            animation: sparkle 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.8; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }

        @keyframes sparkle {
            0% { box-shadow: 0 0 20px rgba(38, 222, 129, 0.5); }
            50% { box-shadow: 0 0 30px rgba(38, 222, 129, 0.8); }
            100% { box-shadow: 0 0 20px rgba(38, 222, 129, 0.5); }
        }

        @media (max-width: 480px) {
            .title {
                font-size: 1.5rem;
            }
            .subtitle {
                font-size: 1rem;
            }
            .story-text {
                font-size: 0.95rem;
            }
            .game-container {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- タイトル画面 -->
        <div class="title-screen" id="titleScreen">
            <div class="title">Sマーダー工業高校</div>
            <div class="subtitle">サイコスリラー「ポールの呪い」</div>
            <button class="start-btn" id="startButton">ゲームスタート</button>
        </div>

        <!-- ゲーム画面 -->
        <div class="game-screen" id="gameScreen">
            <div class="story-area" id="storyArea">
                <div class="character-name" id="characterName"></div>
                <div class="story-text" id="storyText"></div>
                <div class="choices" id="choices"></div>
                <button class="next-btn" id="nextBtn" style="display: none;">次へ</button>
            </div>
        </div>
    </div>

    <script>
        // グローバル変数
        let currentSceneData = null;
        let currentIndex = 0;

        // シーンデータ
        const allScenes = {
            // プロローグ
            opening: [
                {
                    character: "",
                    text: "霧深い山間部にあるSマーダー工業高校。創立から30年が経つこの学校には、恐ろしい噂があった。",
                    type: "story"
                },
                {
                    character: "",
                    text: "『10年おきに、木山という名前の生徒が謎の死を遂げる』その噂を信じる者はいなかった...今日まで。",
                    type: "story"
                },
                {
                    character: "",
                    text: "今日もA木山は電車を乗り過ごし、遅刻しそうになりながら校門をくぐった。しかし、いつもと何かが違う...",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "やばい！また寝過ごした！このままじゃ遅刻だ！",
                    type: "story"
                },
                {
                    character: "",
                    text: "校門では、いつもと違う光景が広がっていた。",
                    type: "choice",
                    choices: [
                        { text: "校門の前で何かを観察する", next: "observe_gate" },
                        { text: "急いで校舎に向かう", next: "rush_to_school" },
                        { text: "他の生徒に話しかける", next: "talk_to_students" }
                    ]
                }
            ],

            // 校門観察ルート
            observe_gate: [
                {
                    character: "",
                    text: "A木山は校門付近を観察した。すると、校門の柱に小さな花束が供えられているのを発見した。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "これって...まさか誰か死んだの？",
                    type: "story"
                },
                {
                    character: "",
                    text: "花束には小さなカードが付いていた。『A木山太郎 享年16歳』『B木山花子 享年16歳』『C木山一郎 享年16歳』",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "木山...？僕と同じ名前...でも、この人たち誰？",
                    type: "story"
                },
                {
                    character: "",
                    text: "その時、背後から声がかかった。",
                    type: "choice",
                    choices: [
                        { text: "振り返る", next: "first_encounter_gate" },
                        { text: "花束をもっと調べる", next: "investigate_flowers" },
                        { text: "急いで逃げる", next: "run_from_gate" }
                    ]
                }
            ],

            investigate_flowers: [
                {
                    character: "",
                    text: "A木山は花束をさらに詳しく調べた。すると、花束の下に古い新聞の切り抜きが隠されているのを発見した。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "『30年前、Sマーダー工業高校生A木山太郎、通学路で事故死』...『20年前、同校生B木山花子...』",
                    type: "story"
                },
                {
                    character: "",
                    text: "全て同じ場所、同じ原因で死んでいる。電柱への激突事故。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "これって...偶然？それとも...",
                    type: "story"
                },
                {
                    character: "",
                    text: "その時、複数の足音が近づいてきた。",
                    type: "choice",
                    choices: [
                        { text: "新聞を隠して立ち上がる", next: "hide_evidence" },
                        { text: "新聞を持って逃げる", next: "take_evidence" },
                        { text: "その場で新聞を読み続ける", next: "continue_reading" }
                    ]
                }
            ],

            // 急行ルート
            rush_to_school: [
                {
                    character: "",
                    text: "A木山は急いで校舎に向かった。しかし、途中で奇妙なことに気づいた。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "あれ？みんな僕のことを見てる...なんで？",
                    type: "story"
                },
                {
                    character: "",
                    text: "すれ違う生徒たちが全員、A木山を見て不気味に微笑んでいる。",
                    type: "story"
                },
                {
                    character: "1年生",
                    text: "あ、D木山先輩だ...今年の...",
                    type: "story"
                },
                {
                    character: "1年生の友達",
                    text: "シーッ！まだ言っちゃダメ！",
                    type: "story"
                },
                {
                    character: "",
                    text: "1年生たちが何かを隠している。",
                    type: "choice",
                    choices: [
                        { text: "1年生たちに話を聞く", next: "talk_first_years" },
                        { text: "無視して教室に急ぐ", next: "ignore_first_years" },
                        { text: "立ち止まって周りを観察する", next: "observe_surroundings" }
                    ]
                }
            ],

            talk_first_years: [
                {
                    character: "A木山",
                    text: "ちょっと待って。今何か言いかけなかった？",
                    type: "story"
                },
                {
                    character: "1年生",
                    text: "え、えーっと...何でもないです！",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "今年の何？僕のことを知ってるの？",
                    type: "story"
                },
                {
                    character: "1年生の友達",
                    text: "あの...D木山先輩、気をつけてくださいね。特に帰り道とか...",
                    type: "story"
                },
                {
                    character: "1年生",
                    text: "バカ！言っちゃダメって言ったのに！",
                    type: "story"
                },
                {
                    character: "",
                    text: "二人は慌てて逃げて行った。",
                    type: "choice",
                    choices: [
                        { text: "二人を追いかける", next: "chase_first_years" },
                        { text: "帰り道が危険？と考える", next: "think_danger" },
                        { text: "教室に向かう", next: "to_classroom_confused" }
                    ]
                }
            ],

            // 他生徒に話しかけるルート
            talk_to_students: [
                {
                    character: "",
                    text: "A木山は近くにいた上級生に話しかけた。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "おはようございます。ちょっとお聞きしたいことが...",
                    type: "story"
                },
                {
                    character: "3年生",
                    text: "君が...D木山くんか。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "はい、そうですが...何か？",
                    type: "story"
                },
                {
                    character: "3年生",
                    text: "...ご愁傷様。",
                    type: "story"
                },
                                {
                    character: "A木山",
                    text: "え？ご愁傷様って...何のことですか？",
                    type: "story"
                },
                {
                    character: "3年生",
                    text: "君はまだ知らないのか...。この学校の伝統を。",
                    type: "story"
                },
                {
                    character: "",
                    text: "3年生の表情が急に暗くなった。",
                    type: "choice",
                    choices: [
                        { text: "伝統について詳しく聞く", next: "ask_tradition" },
                        { text: "不安になって逃げる", next: "flee_from_senior" },
                        { text: "冗談だと思って笑う", next: "laugh_it_off" }
                    ]
                }
            ],

            ask_tradition: [
                {
                    character: "A木山",
                    text: "伝統って何ですか？僕に関係あるんですか？",
                    type: "story"
                },
                {
                    character: "3年生",
                    text: "...木山という名前の生徒は、この学校で10年おきに必ず死ぬ。それが30年続いてる伝統だ。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "そんなバカな...！",
                    type: "story"
                },
                {
                    character: "3年生",
                    text: "信じなくてもいい。でも今日の夕方、君は帰り道でポールに激突して死ぬ。それだけは確実だ。",
                    type: "story"
                },
                {
                    character: "",
                    text: "3年生は重い表情で立ち去った。",
                    type: "choice",
                    choices: [
                        { text: "3年生を追いかけて詳細を聞く", next: "chase_senior" },
                        { text: "信じずに普通に過ごす", next: "disbelieve" },
                        { text: "真剣に受け取って対策を考える", next: "take_seriously" }
                    ]
                }
            ],

            // 教室への道のり
            to_classroom_confused: [
                {
                    character: "",
                    text: "混乱しながらも教室に向かうA木山。廊下で同級生とばったり会った。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "おはよう、O血合。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "あら、A木山♪ 今日は特別な日ね♪ 血液検査の日よ♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "血液検査？そんな予定あったっけ？",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "ええ♪ 特に君の血は...とても美しい色をしてるから♪ 今日見るのが楽しみ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "O血合の目が異常に輝いている。",
                    type: "choice",
                    choices: [
                        { text: "血液検査について詳しく聞く", next: "ask_blood_test" },
                        { text: "O血合の様子がおかしいと指摘", next: "point_out_strange" },
                        { text: "急いで教室に向かう", next: "rush_to_classroom" }
                    ]
                }
            ],

            ask_blood_test: [
                {
                    character: "A木山",
                    text: "血液検査って、保健室でやるの？",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "違うの♪ 特別な場所でやるのよ♪ 君の血が一番美しく見える場所で♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "特別な場所？",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "通学路のポールの前よ♪ そこで君の血を...たっぷりと♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "O血合が舌なめずりをしている。明らかにおかしい。",
                    type: "choice",
                    choices: [
                        { text: "ポールで血液検査？意味がわからない", next: "confused_blood_test" },
                        { text: "O血合から逃げる", next: "run_from_oketsugo" },
                        { text: "O血合の正体を問いただす", next: "confront_oketsugo" }
                    ]
                }
            ],

            // 教室到着
            rush_to_classroom: [
                {
                    character: "",
                    text: "急いで教室に入るA木山。しかし、教室の雰囲気も異様だった。",
                    type: "story"
                },
                {
                    character: "",
                    text: "クラスメイト全員がA木山の方を向いて座っている。全員が不気味に微笑んでいる。",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "おはよう、A木山くん。今日は君にとって...記念すべき日だね。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "Quality（質）の高い一日になりそうだ♪",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "30年に一度の特別な日だからな♪",
                    type: "story"
                },
                {
                    character: "O蔵",
                    text: "僕たちも楽しみにしてたんだ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "全員の発言がどこか意味深だ。",
                    type: "choice",
                    choices: [
                        { text: "みんなに直接聞く「何の話？」", next: "ask_everyone" },
                        { text: "普通を装って席に座る", next: "pretend_normal" },
                        { text: "教室から逃げ出す", next: "flee_classroom" }
                    ]
                }
            ],

            ask_everyone: [
                {
                    character: "A木山",
                    text: "みんな、さっきから何の話をしてるの？30年に一度って何？",
                    type: "story"
                },
                {
                    character: "K山",
                    text: "君の死について話してるんだよ♪",
                    type: "story"
                },
                {
                    character: "土Y",
                    text: "そうそう♪ とても楽しみなイベントなんだ♪",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "僕は君の首を握る瞬間を想像してワクワクしてる♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "僕の...死？君たち、頭がおかしいんじゃないの？",
                    type: "story"
                },
                {
                    character: "全員",
                    text: "おかしいのは君の方だよ♪ 自分が今日死ぬって気づいてないなんて♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "教室全体が狂気に包まれている。",
                    type: "choice",
                    choices: [
                        { text: "席を立って抗議する", next: "protest_loudly" },
                        { text: "担任に助けを求める", next: "ask_teacher_help" },
                        { text: "冷静に状況を分析する", next: "analyze_situation" }
                    ]
                }
            ],

            protest_loudly: [
                {
                    character: "A木山",
                    text: "みんな正気か？人の死を楽しみにするなんて異常だ！",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "異常？僕たちはとてもQuality（質）の高い趣味を持ってるんだ♪",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "そうよ♪ 特に君の血の色は格別なの♪ 30年に一度しか見れない貴重な色♪",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "君の首の感触も楽しみだ♪ どのくらいの握力で砕けるかな♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "みんなの狂気が加速している。",
                    type: "choice",
                    choices: [
                        { text: "教室を飛び出す", next: "escape_classroom" },
                        { text: "警察に通報すると脅す", next: "threaten_police" },
                        { text: "一人一人と話してみる", next: "talk_individually" }
                    ]
                }
            ],

            // 1時間目
            pretend_normal: [
                {
                    character: "",
                    text: "A木山は普通を装って席に座った。1時間目の授業が始まった。",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "今日は特別授業です。テーマは『死』について。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "（え？なんでこのタイミングで死について？）",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "特に、交通事故死について詳しく学びましょう。電柱への激突事故のメカニズムとか♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "担任が黒板に『電柱激突死の美しさ』と書いた。",
                    type: "choice",
                    choices: [
                        { text: "手を上げて質問する", next: "ask_teacher_question" },
                        { text: "ノートを取るふりをして様子を見る", next: "observe_class" },
                        { text: "トイレに行くと言って退室", next: "excuse_bathroom" }
                    ]
                }
            ],

            ask_teacher_question: [
                {
                    character: "A木山",
                    text: "先生、なぜ急に死について学ぶんですか？",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "君のためよ♪ 今日死ぬんだから、死について知っておいた方がいいでしょ？",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "先生まで...！",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "30年前のA木山太郎の死に方はとても美しかった♪ 君もあんな風に死んでくれるのかしら♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "教師まで狂っている。学校全体の問題だ。",
                    type: "choice",
                    choices: [
                        { text: "教室を出る", next: "leave_classroom" },
                        { text: "30年前のことを詳しく聞く", next: "ask_30years_ago" },
                        { text: "録音して証拠を残す", next: "record_evidence" }
                    ]
                }
            ],

            // 休み時間の探索
            leave_classroom: [
                {
                    character: "",
                    text: "A木山は教室を出て廊下を歩いた。すると、壁に張り紙があるのを発見した。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "『D木山処刑観賞会 本日17:30 場所：通学路ポール前 全校生徒参加必須』...処刑？",
                    type: "story"
                },
                {
                    character: "",
                    text: "さらに歩くと、別の張り紙も。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "『木山死体写真コンテスト開催』『最優秀賞には賞金10万円』『審査員：全教職員』",
                    type: "story"
                },
                {
                    character: "",
                    text: "学校全体が自分の死をイベントにしている。",
                    type: "choice",
                    choices: [
                        { text: "校長室に直談判しに行く", next: "to_principal" },
                        { text: "図書館で過去の資料を調べる", next: "to_library" },
                        { text: "保健室に逃げ込む", next: "to_nurse_office" }
                    ]
                }
            ],

            // 図書館調査
            to_library: [
                {
                    character: "",
                    text: "図書館に向かうA木山。司書の先生も不気味に微笑んでいる。",
                    type: "story"
                },
                {
                    character: "司書",
                    text: "あら、A木山くん♪ 自分の死亡記事のテンプレートでも見に来たの？",
                    type: "story"
                },
                
                {
                    character: "A木山",
                    text: "死亡記事のテンプレート？",
                    type: "story"
                },
                {
                    character: "司書",
                    text: "ええ♪ 30年前から使ってる伝統のテンプレートよ♪ 『D木山、電柱激突により死亡』って♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "司書は古いファイルを取り出した。",
                    type: "story"
                },
                {
                    character: "司書",
                    text: "こちらが歴代木山の死体写真コレクション♪ 君の分のスペースも用意してあるのよ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "ファイルの中には恐ろしい写真が並んでいる。",
                    type: "choice",
                    choices: [
                        { text: "写真を詳しく見る", next: "examine_photos" },
                        { text: "ファイルを奪って逃げる", next: "steal_file" },
                        { text: "司書に真実を聞く", next: "ask_librarian_truth" }
                    ]
                }
            ],

            examine_photos: [
                {
                    character: "",
                    text: "A木山は恐る恐る写真を見た。どれも電柱に激突した無残な遺体の写真だった。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "これが...歴代の木山たち...。",
                    type: "story"
                },
                {
                    character: "司書",
                    text: "美しいでしょ？♪ 特にB木山花子の死に顔は芸術的だった♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "写真の隅に小さなメモが挟まっている。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "『木山殺害計画書』『実行者：全校生徒』『方法：心理的圧迫による誘導』...殺害計画？",
                    type: "story"
                },
                {
                    character: "司書",
                    text: "あら、見ちゃった♪ でも大丈夫、もうすぐ君も写真の仲間入りだから♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "これは計画的な殺人だった。",
                    type: "choice",
                    choices: [
                        { text: "計画書を詳しく読む", next: "read_murder_plan" },
                        { text: "証拠を持って逃げる", next: "escape_with_evidence" },
                        { text: "司書を問い詰める", next: "interrogate_librarian" }
                    ]
                }
            ],

            read_murder_plan: [
                {
                    character: "",
                    text: "A木山は震える手で計画書を読んだ。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "『段階1：心理的圧迫』『段階2：逃げ場の封鎖』『段階3：ポールへの誘導』『段階4：死体観賞会』",
                    type: "story"
                },
                {
                    character: "",
                    text: "さらに詳細な記述が続く。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "『全校生徒による監視体制』『警察・行政との癒着により隠蔽』『マスコミ操作』...町全体が共犯？",
                    type: "story"
                },
                {
                    character: "司書",
                    text: "そうよ♪ この町の人たちはみんな木山の死を楽しみにしてるの♪ 10年に一度のお祭りだから♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "絶望的な状況だが、計画書の最後に希望が見えた。",
                    type: "choice",
                    choices: [
                        { text: "計画書の最後を読む", next: "read_plan_end" },
                        { text: "今すぐ町から逃げる", next: "try_escape_town" },
                        { text: "反撃計画を立てる", next: "plan_counter_attack" }
                    ]
                }
            ],

            read_plan_end: [
                {
                    character: "A木山",
                    text: "『注意：ポールの破壊により呪いが解除される可能性あり』『対策：ポール周辺の厳重警備』",
                    type: "story"
                },
                {
                    character: "",
                    text: "ポールを破壊すれば呪いが解ける？",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "『過去の失敗例：握力による破壊未遂事件』『握力は唯一の協力者候補』",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力だけは違う？みんなが狂気に染まる中、握力だけは正常なのか？",
                    type: "story"
                },
                {
                    character: "司書",
                    text: "あら、大事なところまで読んじゃった♪ でも握力くんはもう僕たちの仲間よ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "しかし、A木山は一縷の望みを見つけた。",
                    type: "choice",
                    choices: [
                        { text: "握力を探しに行く", next: "search_for_grip" },
                        { text: "ポールの場所を確認に行く", next: "check_pole_location" },
                        { text: "一人で破壊方法を考える", next: "think_destruction_method" }
                    ]
                }
            ],

            // 2時間目 - 体育の時間
            search_for_grip: [
                {
                    character: "",
                    text: "A木山は握力を探して体育館に向かった。すると、握力が一人で重いダンベルを持ち上げていた。",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "A木山...来たか。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "握力、君は僕の味方？それとも...？",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "...実は俺だけは違うんだ。みんなが狂ってる中、俺だけは正気を保ってる。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "本当に？",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "ああ。俺の握力でポールを破壊すれば、この狂った伝統を終わらせることができる。",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力の目は正気だった。唯一の希望かもしれない。",
                    type: "choice",
                    choices: [
                        { text: "握力に全てを託す", next: "trust_grip_completely" },
                        { text: "一緒に作戦を立てる", next: "plan_with_grip" },
                        { text: "握力の力を試してもらう", next: "test_grip_power" }
                    ]
                }
            ],

            plan_with_grip: [
                {
                    character: "握力",
                    text: "いいか、みんなは放課後にお前をポールまで連行する。その隙に俺がポールを破壊する。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "でも、みんなが監視してるんじゃ...？",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "だからお前が囮になるんだ。みんながお前に夢中になってる間に、俺が背後からポールを破壊する。",
                    type: "story"
                },
                {
                    character: "",
                    text: "その時、体育館に他のクラスメイトが入ってきた。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "あら？握力とA木山が密談してる♪ 何の話かしら♪",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "（小声で）しまった、バレた。作戦変更だ。",
                    type: "story"
                },
                {
                    character: "",
                    text: "危険な状況だ。",
                    type: "choice",
                    choices: [
                        { text: "とぼけて普通の話をしていたふりをする", next: "pretend_normal_talk" },
                        { text: "まQから逃げる", next: "run_from_maq" },
                        { text: "開き直って真実を話す", next: "tell_truth_to_maq" }
                    ]
                }
            ],

            // 昼休み - 食堂での攻防
            pretend_normal_talk: [
                {
                    character: "A木山",
                    text: "あ、まQ。握力と筋トレの話をしてたんだ。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "筋トレ？Quality（質）の低い嘘ね♪ 君たちの会話、全部聞いてたのよ♪",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "チッ...バレてたか。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "握力♪ 君はA木山の味方をするつもり？それとも僕たちの仲間になる？",
                    type: "story"
                },
                {
                    character: "",
                    text: "まQの目が異常に光っている。握力が選択を迫られている。",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "俺は...俺は...",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力が迷っている。",
                    type: "choice",
                    choices: [
                        { text: "握力に逃げるよう言う", next: "tell_grip_to_run" },
                        { text: "まQと交渉する", next: "negotiate_with_maq" },
                        { text: "握力を信じて待つ", next: "trust_grip_decision" }
                    ]
                }
            ],

            trust_grip_decision: [
                {
                    character: "握力",
                    text: "...俺はA木山の味方だ。この狂った学校の伝統を終わらせる。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "そう♪ 残念ね♪ Quality（質）の低い選択だわ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "まQが何かの合図を送ると、体育館にクラスメイト全員が集まってきた。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "握力が裏切り者だって聞いたけど♪ 本当？",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "裏切り者には制裁が必要だな♪",
                    type: "story"
                },
                {
                    character: "O蔵",
                    text: "握力の死体も観賞したいな♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力も危険にさらされた。",
                    type: "choice",
                    choices: [
                        { text: "握力と一緒に戦う", next: "fight_together" },
                        { text: "握力を庇って一人で立ち向かう", next: "protect_grip" },
                        { text: "二人で逃げる", next: "escape_together" }
                    ]
                }
            ],

            fight_together: [
                {
                    character: "A木山",
                    text: "握力、一緒に戦おう！",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "ああ！この狂った連中をぶっ飛ばしてやる！",
                    type: "story"
                },
                {
                    character: "",
                    text: "A木山と握力は背中合わせになって、クラスメイトたちと対峙した。",
                    type: "story"
                },
                {
                    character: "K山",
                    text: "おお♪ 反抗的なA木山も写真に撮りたい♪",
                    type: "story"
                },
                {
                    character: "土Y",
                    text: "抵抗する木山なんて初めて見る♪ ラッキー♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力が近くのダンベルを持ち上げた。",
                    type: "story"
                },
                
                {
                    character: "握力",
                    text: "俺の握力を甘く見るなよ！",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力が100kgのダンベルを片手で振り回した。クラスメイトたちが一瞬ひるんだ。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "今だ！逃げよう！",
                    type: "story"
                },
                {
                    character: "",
                    text: "二人は体育館から脱出した。しかし、追手がすぐに迫ってくる。",
                    type: "choice",
                    choices: [
                        { text: "屋上に逃げる", next: "escape_to_rooftop" },
                        { text: "校外に逃げる", next: "escape_outside_school" },
                        { text: "ポールの場所に先回りする", next: "go_to_pole_first" }
                    ]
                }
            ],

            escape_to_rooftop: [
                {
                    character: "",
                    text: "屋上に逃げた二人。しかし、屋上の扉が施錠されていて出られない。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "閉じ込められた...！",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "大丈夫だ。この扉くらい俺の握力で...",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力がドアノブを握ると、メキメキと音を立てて壊れた。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "すごい...！君の握力は本物だ！",
                    type: "story"
                },
                {
                    character: "",
                    text: "その時、階段から追手の足音が聞こえてきた。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "屋上にいるわよ♪ 逃がさない♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "屋上は袋小路だった。",
                    type: "choice",
                    choices: [
                        { text: "屋上から飛び降りる", next: "jump_from_roof" },
                        { text: "追手と最後の戦いをする", next: "final_rooftop_battle" },
                        { text: "握力に任せて隠れる", next: "hide_behind_grip" }
                    ]
                }
            ],

            final_rooftop_battle: [
                {
                    character: "",
                    text: "クラスメイト全員が屋上に現れた。もう逃げ場はない。",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "A木山くん、握力くん。おとなしく降参しなさい。",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "絶対に嫌だ！俺はA木山を守る！",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力が屋上の手すりを握ると、コンクリートが砕けた。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "すごい握力♪ でも無駄よ♪ 君たち二人じゃ僕たち全員には勝てない♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "握力、君だけでも逃げてくれ。僕のせいで君まで巻き込みたくない。",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "バカ言うな。最後まで一緒だ。",
                    type: "story"
                },
                {
                    character: "",
                    text: "感動的な友情の瞬間。しかし状況は絶望的だ。",
                    type: "choice",
                    choices: [
                        { text: "握力と背中合わせで最後まで戦う", next: "fight_to_the_end" },
                        { text: "交渉を試みる", next: "try_negotiation" },
                        { text: "奇跡を信じて時間を稼ぐ", next: "buy_time" }
                    ]
                }
            ],

            // 放課後 - 運命の時
            fight_to_the_end: [
                {
                    character: "",
                    text: "しかし、多勢に無勢。二人は結局捕まってしまった。",
                    type: "story"
                },
                {
                    character: "全員",
                    text: "観念しなさい♪ もう時間よ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "放課後。運命の時間が来た。A木山は全校生徒に囲まれてポールに向かって歩かされている。",
                    type: "story"
                },
                {
                    character: "校長",
                    text: "さあ、30年に一度の伝統行事の始まりです♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "町の人々も集まってきた。本当に町全体が共犯だった。",
                    type: "story"
                },
                {
                    character: "町の人A",
                    text: "今年の木山はどんな死に方をするかしら♪",
                    type: "story"
                },
                {
                    character: "町の人B",
                    text: "30年前のA木山太郎は最高だったわ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "絶望的な状況。しかし、握力だけが違った。",
                    type: "choice",
                    choices: [
                        { text: "握力に最後の希望を託す", next: "final_hope_grip" },
                        { text: "自分で最後の抵抗をする", next: "final_resistance" },
                        { text: "運命を受け入れる", next: "accept_fate_final" }
                    ]
                }
            ],

            final_hope_grip: [
                {
                    character: "",
                    text: "例のポールが見えてきた。全校生徒と町の人々が取り囲んでいる。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "握力...君だけが頼りだ。",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "任せろ。30年間の狂気を今日で終わらせてやる。",
                    type: "story"
                },
                {
                    character: "",
                    text: "群衆の中で、一人だけ違う動きをする者がいた。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "さあA木山♪ 美しく死んで♪",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "Quality（質）の高い最期を見せて♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "しかし、群衆の後ろから握力がポールに近づいていた。",
                    type: "story"
                },
                {
                    character: "",
                    text: "ランダムで運命が決まる瞬間...",
                    type: "random_companion"
                }
            ],

            // 5時間目 - 音楽の時間（サブストーリー）
            music_class: [
                {
                    character: "",
                    text: "音楽の時間。なぜか全員で『葬送行進曲』を歌わされている。",
                    type: "story"
                },
                {
                    character: "音楽教師",
                    text: "はい、みなさん。A木山くんのために心を込めて歌いましょう♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "（僕のために？まるで葬式の練習みたいだ...）",
                    type: "story"
                },
                {
                    character: "",
                    text: "歌の途中で、歌詞が変わった。",
                    type: "story"
                },
                {
                    character: "全員",
                    text: "♪木山は死ぬ 木山は死ぬ ポールにぶつかり血を流す♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "何だその歌詞！",
                    type: "story"
                },
                {
                    character: "音楽教師",
                    text: "伝統の歌よ♪ 30年前から歌い継がれてるの♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "もう学校全体が狂っている。",
                    type: "choice",
                    choices: [
                        { text: "歌うのを拒否する", next: "refuse_to_sing" },
                        { text: "教室から逃げ出す", next: "escape_music_room" },
                        { text: "握力を探しに行く", next: "search_grip_again" }
                    ]
                }
            ],

            // 6時間目 - 最後の授業
            final_class: [
                {
                    character: "",
                    text: "最後の授業。担任が黒板に絵を描いている。",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "これがA木山くんの死に様の予想図です♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "黒板には電柱に激突する人の絵が描かれている。",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "血の飛び散り方、体の折れ曲がり方、全て計算済みです♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "先生...どうして僕を殺そうとするんですか？",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "殺すなんてひどい言い方♪ 私たちは君を『昇華』させてあげるのよ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "もう話し合いは無意味だった。",
                    type: "choice",
                    choices: [
                        { text: "窓から逃げる", next: "window_escape" },
                        { text: "最後の説得を試みる", next: "final_persuasion" },
                        { text: "時間稼ぎをする", next: "stall_for_time" }
                    ]
                }
            ],

            // 運命の瞬間 - ランダム分岐
            // 握力のハッピーエンディング
            happy_ending: [
                {
                    character: "",
                    text: "その時、群衆の中から握力が飛び出した！",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "A木山！今だ！",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力が例のポールに向かって走った。",
                    type: "story"
                },
                {
                    character: "全員",
                    text: "握力を止めろ♪",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "30年間の狂気よ、今こそ終われ！うおおおおお！",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力がポールを両手で掴んだ瞬間！",
                    type: "story"
                },
                {
                    character: "",
                    text: "メキメキメキメキ...！",
                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "",
                    text: "コンクリート製のポールが握力の超人的な力で完全に粉砕された！",
                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "全員",
                    text: "あああああ！ポールが！伝統が！",
                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "",
                    text: "その瞬間、町の人々の目に正気が戻った。",
                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "町の人A",
                    text: "あれ？私たち何をしてたの？",
                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "O血合",
                    text: "え？僕、どうして血のことばかり考えてたんだろう...",
                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "握力",
                    text: "やった！ポールを破壊したら、みんなの洗脳が解けた！",
                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "A木山",
                    text: "握力...君が僕を、そして未来の木山たちを救ってくれたんだ！",

                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "",
                    text: "HAPPY END - 握力の超人的な力で30年間の呪いと狂気が完全に終わった！",
                    type: "ending"
                }
            ],

            // O血合エンド - 血への執着
            o_ketsugo_end: [
                {
                    character: "",
                    text: "群衆の中からO血合が一番に飛び出してきた。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "A木山〜♪ 私が一番乗り♪ 君の美しい血を最初に浴びる特権をいただくわ♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "O血合...君は本当に狂ってるんだな。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "狂ってる？失礼ね♪ 私は血液の美しさを理解できる選ばれた人間なのよ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "O血合が小さな注射器を取り出した。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "まずは生きてる間に少し採血させて♪ 新鮮な血と死体の血、両方楽しみたいの♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "ポールが目前に迫る中、O血合の狂気的な笑顔に気を取られ、A木山はハンドルを切り損ねた。",
                    type: "story"
                },
                {
                    character: "",
                    text: "ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "O血合",
                    text: "ああ〜♪ 最高の血の色♪ この瞬間のために30年待ったかいがあった♪",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - O血合の血液への異常な執着が最後まで続いた",
                    type: "ending"
                }
            ],

            // まQエンド - Quality（質）へのこだわり
            maq_end: [
                {
                    character: "",
                    text: "群衆の中からまQが優雅に現れた。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "A木山〜♪ 君のためにQuality（質）の高い死の演出を用意したよ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "まQが例の怪しい薬を取り出した。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "これを飲めば、死ぬ時により美しく、よりQuality高く死ねるよ〜♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "そんなもの飲むわけないだろ！",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "あら、残念♪ でも大丈夫、Quality Danceで君の死を美しく演出してあげる♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "ポールの前でまQが狂ったように踊り始めた。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "♪Quality Death Dance♪ 君への最高の送別の踊り♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "まQの狂った踊りと歌声に気を取られ、A木山はポールに激突！",
                    type: "story"
                },
                {
                    character: "",
                    text: "ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "まQ",
                    text: "Perfect Quality♪ 最高の死に顔だ♪ さすが僕のプロデュース♪",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - まQのQuality Danceは文字通り死の舞踊だった",
                    type: "ending"
                }
            ],

            // O村エンド - 死体観察への興奮
            o_mura_end: [
                {
                    character: "",
                    text: "群衆の中からO村が興奮して飛び出してきた。",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "A木山〜♪ 俺が君の死体の第一発見者になる権利をゲットしたぜ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "O村が高性能の望遠鏡を構えている。",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "君の死に顔を最高の角度から観察してやる♪ 毛穴まで見えるぞ♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "気持ち悪い...！",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "30年前のA木山太郎の死体写真は最高だった♪ でも君はもっと美しく死んでくれるよな♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "O村が興奮のあまり先回りしようとして転倒！",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "うわあああ！",
                    type: "story"
                },
                {
                    character: "",
                    text: "転倒したO村に巻き込まれて、A木山もポールに激突！",
                    type: "story"
                },
                {
                    character: "",
                    text: "ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "O村",
                    text: "やった〜♪ 俺も一緒に血まみれ♪ 最高の体験だ♪ 近距離で観察できる♪",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - O村の興奮が悲劇を加速させた",
                    type: "ending"
                }
            ],

            // O蔵エンド - 死体愛好
            o_zou_end: [
                {
                    character: "",
                    text: "群衆の中からO蔵がゆっくりと現れた。",
                    type: "story"
                },
                {
                    character: "O蔵",
                    text: "A木山〜♪ 僕は君の死体を一番長時間観察する権利をもらったよ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "O蔵が手に花束を持っている。",
                    type: "story"
                },
                {
                    character: "O蔵",
                    text: "これは君の死体に供える花よ♪ 美しい死体には美しい花が似合うからね♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "まだ死んでもいないのに...！",
                    type: "story"
                },
                {
                    character: "O蔵",
                    text: "大丈夫♪ すぐに美しい死体になるから♪ 僕が君の死体を愛でてあげる♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "O蔵がポールの前で手を広げて待ち構えている。",
                    type: "story"
                },
                {
                    character: "O蔵",
                    text: "さあ、美しく死んで♪ 僕の腕の中で永遠に眠りなさい♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "O蔵の恐ろしい愛情表現に恐怖し、A木山は避けきれずポールに激突！",
                    type: "story"
                },
                {
                    character: "",
                    text: "ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "O蔵",
                    text: "ああ〜♪ 美しい〜♪ 最高の死体♪ ずっとずっと見ていたい♪",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - O蔵の歪んだ愛情が実現してしまった",
                    type: "ending"
                }
            ],

            // K山エンド - 死体写真撮影
            k_yama_end: [
                {
                    character: "",
                    text: "群衆の中からK山が巨大なカメラを抱えて現れた。",
                    type: "story"
                },
                {
                    character: "K山",
                    text: "A木山〜♪ 僕が君の死ぬ瞬間を完璧に撮影してあげる♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "K山が超高性能の一眼レフカメラを構えている。",
                    type: "story"
                },
                {
                    character: "K山",
                    text: "8K画質の超高画質で、君の死に顔を永遠に保存してあげる♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "写真を撮るって...僕の死体の？",
                    type: "story"
                },
                {
                    character: "K山",
                    text: "そうだよ♪ SNSにアップして世界中に自慢するんだ♪ #木山死体 #最高の死に顔♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "ポールが見えてきた時、K山が強力なフラッシュを焚いた！",
                    type: "story"
                },
                {
                    character: "K山",
                    text: "はい、チーズ♪ あ、もうすぐ死ぬから『さよなら』の方がいいかな♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "強烈なフラッシュで目がくらみ、A木山はポールに激突！",
                    type: "story"
                },
                {
                    character: "",
                    text: "ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "K山",
                    text: "完璧な写真が撮れた♪ いいね♪ が1万個は確実だ♪",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - K山の撮影が最悪のタイミングで行われた",
                    type: "ending"
                }
            ],

            // 土Yエンド - 悪運の発動
            do_y_end: [
                {
                    character: "",
                    text: "群衆の中から土Yが怪しいお守りを振り回して現れた。",
                    type: "story"
                },
                {
                    character: "土Y",
                    text: "A木山〜♪ 僕のラッキーアイテムで君をより確実に死なせてあげる♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "土Yが『絶対死亡のお守り』を掲げている。",
                    type: "story"
                },
                {
                    character: "土Y",
                    text: "このお守りは30年間、100%の成功率を誇ってるんだ♪ 今年も安心だね♪",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "そんなオカルトグッズに頼らなくても...！",
                    type: "story"
                },
               
                {
                    character: "土Y",
                    text: "オカルト？失礼な♪ これは科学的に証明された確率操作アイテムなんだよ♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "ポールが見えてきた時、土Yが怪しい呪文を唱え始めた。",
                    type: "story"
                },
                {
                    character: "土Y",
                    text: "死ね死ね死ね〜♪ ラッキーデス〜♪ 不運よ降り注げ〜♪",
                    type: "story"
                },
                {
                    character: "",
                    text: "すると本当に不運が降り注いだ。",
                    type: "story"
                },
                {
                    character: "",
                    text: "突然の強風、道路の段差、対向車のクラクション、全てが重なった瞬間...",
                    type: "story"
                },
                {
                    character: "",
                    text: "ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "土Y",
                    text: "ラッキー♪ お守りの効果は完璧♪ 30年間無敗記録継続中♪",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - 土Yの悪運操作が恐ろしいほど的確だった",
                    type: "ending"
                }
            ],

            // エピローグ（ハッピーエンド以外の場合）
            epilogue: [
                {
                    character: "",
                    text: "翌日、Sマーダー工業高校には静寂が戻っていた。",
                    type: "story"
                },
                {
                    character: "",
                    text: "校庭には新しい慰霊碑が建てられた。『D木山 享年16歳』",
                    type: "story"
                },
                {
                    character: "",
                    text: "そして一週間後...",
                    type: "story"
                },
                {
                    character: "",
                    text: "新しい転校生がやってきた。",
                    type: "story"
                },
                {
                    character: "新転校生",
                    text: "はじめまして！E木山です！よろしくお願いします！",
                    type: "story"
                },
                {
                    character: "全員",
                    text: "ええええええ！！！また木山！？",
                    type: "story"
                },
                {
                    character: "",
                    text: "しかし今度は違った。みんなの反応が微妙に変化していた。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "また血を見れるのね♪ でも...なんだかD木山の血が忘れられない...",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "またQuality（質）の高い死を演出できる♪ でも前回が完璧すぎて...",
                    type: "story"
                },
                {
                    character: "",
                    text: "前回の『作品』があまりにも完璧だったため、みんなの期待値が上がりすぎていた。",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "今度はD木山を超える死に方をしてもらわないと...",
                    type: "story"
                },
                {
                    character: "",
                    text: "そして『E木山完全死亡プロジェクト』が始動した。",
                    type: "story"
                },
                {
                    character: "",
                    text: "前回の経験を活かし、より精密で、より残酷で、より美しい死を演出するために...",
                    type: "story"
                },
                {
                    character: "",
                    text: "この狂気のサイクルはいつまで続くのだろうか...",
                    type: "story"
                },
                {
                    character: "",
                    text: "そして10年後、20年後、また新しい木山が現れるのだろう。",
                    type: "story"
                },
                {
                    character: "",
                    text: "永遠に続く、Sマーダー工業高校の恐ろしい伝統...",
                    type: "story"
                },
                {
                    character: "",
                    text: "TO BE CONTINUED...",
                    type: "ending"
                }
            ]
        };

        let currentSceneData = allScenes.opening;
        let currentIndex = 0;

        // 初期化
        function initGame() {
            document.getElementById('startButton').addEventListener('click', startGame);
            document.getElementById('nextBtn').addEventListener('click', nextScene);
        }

        function startGame() {
            console.log('ゲーム開始');
            document.getElementById('titleScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'flex';
            showScene();
        }

        function showScene() {
            const scene = currentSceneData[currentIndex];
            
            if (!scene) {
                console.log('シーンが見つかりません');
                return;
            }

            const storyArea = document.getElementById('storyArea');
            const characterName = document.getElementById('characterName');
            const storyText = document.getElementById('storyText');
            const choices = document.getElementById('choices');
            const nextBtn = document.getElementById('nextBtn');

            // シーンの特殊演出
            if (scene.isDeathScene) {
                storyArea.classList.add('death-scene');
                storyArea.classList.remove('happy-ending');
            } else if (scene.isHappyScene) {
                storyArea.classList.add('happy-ending');
                storyArea.classList.remove('death-scene');
            } else {
                storyArea.classList.remove('death-scene', 'happy-ending');
            }

            // キャラクター名の表示制御
            if (scene.character === "") {
                characterName.style.display = 'none';
            } else {
                characterName.style.display = 'block';
                characterName.textContent = scene.character;
            }
            
            storyText.textContent = scene.text;
            choices.innerHTML = '';

            if (scene.type === 'choice') {
                nextBtn.style.display = 'none';
                scene.choices.forEach((choice, index) => {
                    const button = document.createElement('button');
                    button.className = 'choice-btn';
                    button.textContent = choice.text;
                    button.addEventListener('click', () => selectChoice(choice.next));
                    choices.appendChild(button);
                });
            } else if (scene.type === 'random_companion') {
                // ランダム同行者選択
                selectRandomCompanion();
                return;
            } else if (scene.type === 'ending') {
                nextBtn.style.display = 'none';
                
                // ハッピーエンドでない場合のみエピローグボタンを表示
                if (!scene.isHappyScene) {
                    const epilogueBtn = document.createElement('button');
                    epilogueBtn.className = 'choice-btn';
                    epilogueBtn.textContent = 'エピローグを見る';
                    epilogueBtn.addEventListener('click', showEpilogue);
                    choices.appendChild(epilogueBtn);
                }
                
                const titleBtn = document.createElement('button');
                titleBtn.className = 'choice-btn';
                titleBtn.textContent = 'タイトルに戻る';
                titleBtn.addEventListener('click', () => location.reload());
                choices.appendChild(titleBtn);
            } else {
                nextBtn.style.display = 'block';
                
                // nextプロパティがある場合は自動で次のシーンに移行
                if (scene.next) {
                    nextBtn.onclick = () => selectChoice(scene.next);
                } else {
                    nextBtn.onclick = nextScene;
                }
            }
        }

        function nextScene() {
            currentIndex++;
            if (currentIndex >= currentSceneData.length) {
                return;
            }
            showScene();
        }

        function selectChoice(nextSceneKey) {
            console.log('選択されたシーン:', nextSceneKey);
            if (allScenes[nextSceneKey]) {
                currentSceneData = allScenes[nextSceneKey];
                currentIndex = 0;
                showScene();
            } else {
                console.log('シーンが見つかりません:', nextSceneKey);
            }
        }

        function selectRandomCompanion() {
            // 握力の確率を低く設定（8%）、他は各約15%
            const random = Math.random();
            let selectedEnding;
            
            if (random < 0.08) {
                selectedEnding = 'happy_ending';
            } else if (random < 0.23) {
                selectedEnding = 'o_ketsugo_end';
            } else if (random < 0.38) {
                selectedEnding = 'maq_end';
            } else if (random < 0.53) {
                selectedEnding = 'o_mura_end';
            } else if (random < 0.68) {
                selectedEnding = 'o_zou_end';
            } else if (random < 0.83) {
                selectedEnding = 'k_yama_end';
            } else {
                selectedEnding = 'do_y_end';
            }
            
            currentSceneData = allScenes[selectedEnding];
            currentIndex = 0;
            showScene();
        }

        function showEpilogue() {
            currentSceneData = allScenes.epilogue;
            currentIndex = 0;
            showScene();
        }

        // ページ読み込み時に初期化
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #ff6b6b;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: #ffa726;
        }

        .game-screen {
            display: none;
            flex-direction: column;
            justify-content: center;
        }

        .story-area {
            background: rgba(0,0,0,0.7);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 200px;
            border: 2px solid #444;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .character-name {
            color: #4fc3f7;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .story-text {
            line-height: 1.6;
            font-size: 1rem;
            margin-bottom: 15px;
            flex-grow: 1;
            display: flex;
            align-items: center;
        }

        .choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .choice-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            padding: 15px;
            border-radius: 8px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .choice-btn:hover {
            background: linear-gradient(45deg, #764ba2, #667eea);
            border-color: #fff;
            transform: translateY(-2px);
        }

        .start-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .start-btn:hover {
            background: linear-gradient(45deg, #ee5a24, #ff6b6b);
            transform: scale(1.05);
        }

        .next-btn {
            background: linear-gradient(45deg, #26de81, #20bf6b);
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 15px;
            align-self: center;
        }

        .death-scene {
            background: linear-gradient(135deg, #c0392b, #8e44ad);
            color: #fff;
            text-align: center;
            animation: pulse 2s infinite;
        }

        .happy-ending {
            background: linear-gradient(135deg, #26de81, #20bf6b);
            color: #fff;
            text-align: center;
            animation: sparkle 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.8; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }

        @keyframes sparkle {
            0% { box-shadow: 0 0 20px rgba(38, 222, 129, 0.5); }
            50% { box-shadow: 0 0 30px rgba(38, 222, 129, 0.8); }
            100% { box-shadow: 0 0 20px rgba(38, 222, 129, 0.5); }
        }

        @media (max-width: 480px) {
            .title {
                font-size: 1.5rem;
            }
            .subtitle {
                font-size: 1rem;
            }
            .story-text {
                font-size: 0.95rem;
            }
            .game-container {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- タイトル画面 -->
        <div class="title-screen" id="titleScreen">
            <div class="title">Sマーダー工業高校</div>
            <div class="subtitle">サイコスリラー「ポールの呪い」</div>
            <button class="start-btn" onclick="startGame()">ゲームスタート</button>
        </div>

        <!-- ゲーム画面 -->
        <div class="game-screen" id="gameScreen">
            <div class="story-area" id="storyArea">
                <div class="character-name" id="characterName"></div>
                <div class="story-text" id="storyText"></div>
                <div class="choices" id="choices"></div>
                <button class="next-btn" id="nextBtn" onclick="nextScene()" style="display: none;">次へ</button>
            </div>
        </div>
    </div>

    <script>
        let currentScene = 0;
        let gameState = 'start';
        let playerChoices = [];

        // 全シーンデータをひとつのオブジェクトに統合
        const allScenes = {
            // オープニング
            opening: [
                {
                    character: "",
                    text: "Sマーダー工業高校。今日もA木山は遅刻しそうになりながら校門をくぐった。しかし、いつもと何かが違う...空気が重い。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "うわあああ！遅刻する〜！どうやって教室に行こう？",
                    type: "choice",
                    choices: [
                        { text: "階段を駆け上がる", next: "stairs" },
                        { text: "エレベーターを使う", next: "elevator" },
                        { text: "裏口から入る", next: "backgate" }
                    ]
                }
            ],

            // 階段ルート
            stairs: [
                {
                    character: "",
                    text: "階段を駆け上がるA木山。途中でO血合とばったり会った。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "あ、A木山！一緒に行こう！でも階段は危険だよ...転んだらどうする？",
                    type: "story"
                },
                {
                    character: "",
                    text: "O血合の心配そうな表情。どう対応する？",
                    type: "choice",
                    choices: [
                        { text: "心配してくれてありがとう", next: "classroom_entry" },
                        { text: "なぜそんなに心配するの？", next: "classroom_entry" },
                        { text: "急いでいるから先に行く", next: "classroom_entry" }
                    ]
                }
            ],

            // エレベーターループ
            elevator: [
                {
                    character: "",
                    text: "エレベーターに向かうA木山。中にはまQがいた。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "おはよう、A木山！僕と一緒にエレベーター？でも...閉じ込められたら危険だよね？",
                    type: "story"
                },
                {
                    character: "",
                    text: "まQも妙に心配している。どう答える？",
                    type: "choice",
                    choices: [
                        { text: "一緒に乗ろう", next: "classroom_entry" },
                        { text: "なぜ危険だと思うの？", next: "classroom_entry" },
                        { text: "やっぱり階段にする", next: "classroom_entry" }
                    ]
                }
            ],

            // 裏口ルート
            backgate: [
                {
                    character: "",
                    text: "裏口から入ろうとするA木山。そこにはO村とO蔵がいた。",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "おっ、A木山！裏口作戦？でも段差があって危険だぞ？",
                    type: "story"
                },
                {
                    character: "O蔵",
                    text: "そうそう！転んだら大変！僕たちが先導するよ！",
                    type: "story"
                },
                {
                    character: "",
                    text: "この二人も過保護だ。どうする？",
                    type: "choice",
                    choices: [
                        { text: "先導してもらう", next: "classroom_entry" },
                        { text: "なぜみんな僕を心配するの？", next: "classroom_entry" },
                        { text: "一人で入る", next: "classroom_entry" }
                    ]
                }
            ],

            // 教室入室
            classroom_entry: [
                {
                    character: "",
                    text: "教室に入ると、クラスメイト全員がA木山の方を振り返った。そして...不気味に微笑んだ。",
                    type: "story"
                },
                {
                    character: "担任",
                    text: "おはよう、A木山くん。今日は...特別な日だね。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "おはよう、A木山！僕、今日血液検査があるんだ！君の血液型、何型だっけ？",
                    type: "story"
                },
                {
                    character: "",
                    text: "血液型を聞かれた。どう答える？",
                    type: "choice",
                    choices: [
                        { text: "A型だよ", next: "morning_class" },
                        { text: "なぜ血液型を聞くの？", next: "morning_class" },
                        { text: "教えたくない", next: "morning_class" }
                    ]
                }
            ],

            // 午前の授業
            morning_class: [
                {
                    character: "",
                    text: "1時間目の授業中、A木山は妙な視線を感じていた。授業に集中できない。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "（小声で）A木山、放課後に大事な話があるんだ。君の命に関わることかもしれない...",
                    type: "story"
                },
                {
                    character: "",
                    text: "2時間目が終わると、O村とO蔵が近づいてきた。",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "よお、A木山。今日の体調はどうだ？自転車の運転に支障はないよね？",
                    type: "story"
                },
                {
                    character: "",
                    text: "自転車の話が出た。どう答える？",
                    type: "choice",
                    choices: [
                        { text: "なぜ自転車のことを聞くの？", next: "lunch_time" },
                        { text: "体調は問題ない", next: "lunch_time" },
                        { text: "何か知ってるでしょ？", next: "lunch_time" }
                    ]
                }
            ],

            // 昼休み
            lunch_time: [
                {
                    character: "",
                    text: "昼休み。A木山は今朝からの違和感について考えていた。",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "A木山！今日はどこで昼食を取る？僕が君を完全にサポートするよ！",
                    type: "story"
                },
                {
                    character: "",
                    text: "どこで昼食を取る？",
                    type: "choice",
                    choices: [
                        { text: "食堂でまQと話す", next: "maq_talk" },
                        { text: "屋上でO村・O蔵と話す", next: "ou_talk" },
                        { text: "体育館で握力と話す", next: "grip_talk" },
                        { text: "教室でK山・土Yと話す", next: "k_do_talk" }
                    ]
                }
            ],

            // まQとの会話
            maq_talk: [
                {
                    character: "まQ",
                    text: "やあA木山！僕の名前の由来知ってる？真のQuality...つまり真のクオリティの略なんだ！",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "今朝から、みんなの様子がおかしいんだ。何か知らない？",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "ああ...実は僕たちには使命があるんだ。君を守る使命が！",

                    type: "story"
                },
                {
                    character: "",
                    text: "使命？どう反応する？",
                    type: "choice",
                    choices: [
                        { text: "どんな使命？", next: "afternoon" },
                        { text: "何から守るの？", next: "afternoon" },
                        { text: "信じられない", next: "afternoon" }
                    ]
                }
            ],

            // O村・O蔵との会話
            ou_talk: [
                {
                    character: "O村",
                    text: "よお、A木山！俺たちの名前、なんか似てない？",
                    type: "story"
                },
                {
                    character: "O蔵",
                    text: "そうそう！運命を感じるよね〜。でも君の名前はもっと特別だ。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "特別って何が？",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "『木山』という名前には...恐ろしい呪いがあるんだ。",
                    type: "story"
                },
                {
                    character: "",
                    text: "呪い？どう答える？",
                    type: "choice",
                    choices: [
                        { text: "どんな呪い？", next: "afternoon" },
                        { text: "そんなの信じない", next: "afternoon" },
                        { text: "詳しく教えて", next: "afternoon" }
                    ]
                }
            ],

            // 握力との会話
            grip_talk: [
                {
                    character: "握力",
                    text: "おっ、A木山！握力測定やろうぜ！",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "なんで君はそんなに僕を守ろうとするの？",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "それは...この握力で君を絶対に守るって決めたからだ！何があっても！",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力が手本を見せると...バキッ！握力計が壊れた。",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "あ、やっちゃった...てへ☆",
                    type: "story"
                },
                {
                    character: "",
                    text: "すごい握力だ。どう反応する？",
                    type: "choice",
                    choices: [
                        { text: "すごい力だね", next: "afternoon" },
                        { text: "何から守ってくれるの？", next: "afternoon" },
                        { text: "その力で何ができるの？", next: "afternoon" }
                    ]
                }
            ],

            // K山・土Yとの会話
            k_do_talk: [
                {
                    character: "K山",
                    text: "A木山！僕、実は...実は君に言いたいことがあるんだ！",
                    type: "story"
                },
                {
                    character: "土Y",
                    text: "待って！それ僕が言おうとしてたことだ！",
                    type: "story"
                },
                {
                    character: "K山",
                    text: "君は最近、悪い夢とか見てない？自転車に関する夢とか...",
                    type: "story"
                },
                {
                    character: "土Y",
                    text: "特にポールとか...！",
                    type: "story"
                },
                {
                    character: "",
                    text: "ポール？確かに最近変な夢を見る。どう答える？",
                    type: "choice",
                    choices: [
                        { text: "実は変な夢を見るんだ", next: "afternoon" },
                        { text: "なんで君たちがそれを知ってるの？", next: "afternoon" },
                        { text: "ポールって何のこと？", next: "afternoon" }
                    ]
                }
            ],

            // 午後
            afternoon: [
                {
                    character: "",
                    text: "放課後。A木山は今日一日の出来事を振り返っていた。真相を探るべきだ。",
                    type: "story"
                },
                {
                    character: "",
                    text: "どこで真相を探る？",
                    type: "choice",
                    choices: [
                        { text: "図書館で調べる", next: "library" },
                        { text: "みんなを集めて直接聞く", next: "direct_ask" },
                        { text: "一人で考える", next: "think_alone" }
                    ]
                }
            ],

            // 図書館
            library: [
                {
                    character: "",
                    text: "図書館で古い新聞を調べるA木山。そこで驚くべき記事を発見した。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "『30年前、A木山太郎が自転車で帰宅中、電柱に激突して死亡』...『20年前、B木山花子』...『10年前、C木山一郎』...",
                    type: "story"
                },
                {
                    character: "",
                    text: "全員、同じ場所のポールで事故死している。そして今年は...",
                    type: "story"
                },
                {
                    character: "",
                    text: "真相が分かった。どうする？",
                    type: "choice",
                    choices: [
                        { text: "みんなに確認する", next: "revelation" },
                        { text: "一人で帰宅する", next: "revelation" },
                        { text: "今日は帰らない", next: "revelation" }
                    ]
                }
            ],

            // 直接質問
            direct_ask: [
                {
                    character: "",
                    text: "A木山はクラスメイト全員を集めた。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "みんな、今日は何か隠してるよね？正直に教えて。",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "もう隠しても仕方ないか...",
                    type: "story"
                },
                {
                    character: "",
                    text: "ついに白状する気になったようだ。",
                    type: "choice",
                    choices: [
                        { text: "全部教えて", next: "revelation" },
                        { text: "僕に関係あるの？", next: "revelation" },
                        { text: "やっぱりそうだったのか", next: "revelation" }
                    ]
                }
            ],

            // 一人で考える
            think_alone: [
                {
                    character: "",
                    text: "A木山は一人で今日の出来事を整理した。みんなの行動、不自然な心配、自転車への言及...",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "まさか...僕に何か危険が迫ってるってこと？",
                    type: "story"
                },
                {
                    character: "",
                    text: "その時、クラスメイト全員が教室に入ってきた。",
                    type: "story"
                },
                {
                    character: "全員",
                    text: "A木山...話があるんだ。",
                    type: "story"
                },
                {
                    character: "",
                    text: "ついに真相を話してくれるらしい。",
                    type: "choice",
                    choices: [
                        { text: "聞かせて", next: "revelation" },
                        { text: "薄々気づいてた", next: "revelation" },
                        { text: "怖いけど知りたい", next: "revelation" }
                    ]
                }
            ],

            // 真相判明
            revelation: [
                {
                    character: "O血合",
                    text: "もう隠してもしょうがないね。実は僕たちみんな、『A木山を安全に家まで帰らせる委員会』のメンバーなんだ。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "この学校には30年前から呪いがあるんだ！",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "10年おきに『木山』という名前の生徒が帰り道でポールにぶつかって死ぬ！",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "A木山太郎、B木山花子、C木山一郎...そして今度は君の番！",
                    type: "story"
                },
                {
                    character: "K山",
                    text: "僕たちは君を絶対に死なせない！",
                    type: "story"
                },
                {
                    character: "土Y",
                    text: "今日こそ呪いを打ち破るんだ！",
                    type: "story"
                },
                {
                    character: "",
                    text: "いよいよ帰宅時間。どうする？",
                    type: "choice",
                    choices: [
                        { text: "みんなと一緒に帰る", next: "go_home" },
                        { text: "一人で帰る", next: "go_home" },
                        { text: "今日は学校に残る", next: "go_home" },
                        { text: "家族に迎えを頼む", next: "go_home" }
                    ]
                }
            ],

            // 帰宅開始
            go_home: [
                {
                    character: "",
                    text: "結局、A木山は一人で帰ることにした。しかし...",
                    type: "story"
                },
                {
                    character: "",
                    text: "「待ってくれ！」誰かが追いかけてきた。",
                    type: "story"
                },
                {
                    character: "",
                    text: "振り返ると...",
                    type: "story"
                },
                {
                    character: "",
                    text: "ランダムで決まる同行者...",
                    type: "random_companion"
                }
            ],

            // 握力ハッピーエンド
            happy_ending: [
                {
                    character: "握力",
                    text: "A木山！一人で帰るなんて危険すぎる！僕がついて行く！",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "握力...ありがとう。",
                    type: "story"
                },
                {
                    character: "",
                    text: "そして例のポールが見えてきた。",
                    type: "story"
                },
                {
                    character: "A木山",
                    text: "あれが...呪いのポール。",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "任せろ！僕の握力でこのポールを...！",
                    type: "story"
                },
                {
                    character: "",
                    text: "握力がポールを掴んだ瞬間！",
                    type: "story"
                },
                {
                    character: "握力",
                    text: "うおおおおお！",
                    type: "story"
                },
                {
                    character: "",
                    text: "メキメキメキ...！ポールが握りつぶされていく！",
                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "握力",
                    text: "やったあああ！ポールを破壊した！",
                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "A木山",
                    text: "すごい！握力、君が僕を救ってくれたんだ！",
                    type: "story",
                    isHappyScene: true
                },
                {
                    character: "",
                    text: "HAPPY END - 握力の超人的な力で呪いが打ち破られた！",
                    type: "ending"
                }
            ],

            // その他のキャラクターエンド
            o_ketsugo_end: [
                {
                    character: "O血合",
                    text: "A木山！一人は危険だ！僕がついて行く！",
                    type: "story"
                },
                {
                    character: "",
                    text: "O血合と一緒に帰宅。ポールが見えてきた時...",
                    type: "story"
                },
                {
                    character: "O血合",
                    text: "危ない！ポールだ！",
                    type: "story"
                },
                {
                    character: "",
                    text: "O血合の叫び声に驚いてハンドルを切り損ねた。ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - O血合の心配が裏目に出た",
                    type: "ending"
                }
            ],

            maq_end: [
                {
                    character: "まQ",
                    text: "A木山！Quality護衛を発動する！僕がついて行く！",
                    type: "story"
                },
                {
                    character: "",
                    text: "まQと一緒に帰宅。ポールの前でまQがダンスを始めた。",
                    type: "story"
                },
                {
                    character: "まQ",
                    text: "Quality Dance！君を守る踊り！",

                    type: "story"
                },
                {
                    character: "",
                    text: "しかし踊りに気を取られ、A木山はポールに激突！ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - Quality Danceは効果がなかった",
                    type: "ending"
                }
            ],

            o_mura_end: [
                {
                    character: "O村",
                    text: "A木山！運命を変えるために僕がついて行く！",
                    type: "story"
                },
                {
                    character: "",
                    text: "O村と一緒に帰宅。ポールが見えてきた時...",
                    type: "story"
                },
                {
                    character: "O村",
                    text: "俺が先に行って安全確認する！",
                    type: "story"
                },
                {
                    character: "",
                    text: "しかしO村が転倒。それに巻き込まれてA木山もポールに激突！ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - O村の作戦は失敗だった",
                    type: "ending"
                }
            ],

            o_zou_end: [
                {
                    character: "O蔵",
                    text: "A木山！僕が絶対に守る！ついて行く！",
                    type: "story"
                },
                {
                    character: "",
                    text: "O蔵と一緒に帰宅。ポールの前でO蔵が盾になろうとした。",
                    type: "story"
                },
                {
                    character: "O蔵",
                    text: "僕が壁になる！",
                    type: "story"
                },
                {
                    character: "",
                    text: "しかしO蔵が邪魔になり、A木山は避けきれずポールに激突！ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - O蔵の盾作戦は裏目に出た",
                    type: "ending"
                }
            ],

            k_yama_end: [
                {
                    character: "K山",
                    text: "A木山！危険を察知する僕がついて行く！",
                    type: "story"
                },
                {
                    character: "",
                    text: "K山と一緒に帰宅。ポールが見えてきた時...",
                    type: "story"
                },
                {
                    character: "K山",
                    text: "危険だ！今すぐ右に！",
                    type: "story"
                },
                {
                    character: "",
                    text: "しかし右に避けた瞬間、対向車が！慌てて左に戻るとポールが！ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - K山の指示が混乱を招いた",
                    type: "ending"
                }
            ],

            do_y_end: [
                {
                    character: "土Y",
                    text: "A木山！僕の運の良さで君を守る！ついて行く！",
                    type: "story"
                },
                {
                    character: "",
                    text: "土Yと一緒に帰宅。ポールが見えてきた時...",
                    type: "story"
                },
                {
                    character: "土Y",
                    text: "僕の運のパワーで...あれ？今日は運が悪い日だった！",
                    type: "story"
                },
                {
                    character: "",
                    text: "その瞬間、運悪く風が吹いてA木山がポールに激突！ガシャーン！",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "A木山",
                    text: "く、空気がない......",
                    type: "story",
                    isDeathScene: true
                },
                {
                    character: "",
                    text: "BAD END - 土Yの運も今日は効果なし",
                    type: "ending"
                }
            ],

            // エピローグ
            epilogue: [
                {
                    character: "",
                    text: "翌日、Sマーダー工業高校に新しい転校生がやってきた。",
                    type: "story"
                },
                {
                    character: "新転校生",
                    text: "はじめまして！E木山です！よろしくお願いします！",
                    type: "story"
                },
                {
                    character: "全員",
                    text: "ええええええ！！！また木山！？",
                    type: "story"
                },
                {
                    character: "",
                    text: "そして『E木山を安全に家まで帰らせる委員会』が再び始動するのであった...",
                    type: "story"
                },
                {
                    character: "",
                    text: "TO BE CONTINUED...",
                    type: "ending"
                }
            ]
        };

        let currentSceneData = allScenes.opening;
        let currentIndex = 0;

        function startGame() {
            document.getElementById('titleScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'flex';
            showScene();
        }

        function showScene() {
            const scene = currentSceneData[currentIndex];
            
            if (!scene) {
                return;
            }

            const storyArea = document.getElementById('storyArea');
            const characterName = document.getElementById('characterName');
            const storyText = document.getElementById('storyText');
            const choices = document.getElementById('choices');
            const nextBtn = document.getElementById('nextBtn');

            // シーンの特殊演出
            if (scene.isDeathScene) {
                storyArea.classList.add('death-scene');
                storyArea.classList.remove('happy-ending');
            } else if (scene.isHappyScene) {
                storyArea.classList.add('happy-ending');
                storyArea.classList.remove('death-scene');
            } else {
                storyArea.classList.remove('death-scene', 'happy-ending');
            }

            // キャラクター名の表示制御
            if (scene.character === "") {
                characterName.style.display = 'none';
            } else {
                characterName.style.display = 'block';
                characterName.textContent = scene.character;
            }
            
            storyText.textContent = scene.text;
            choices.innerHTML = '';

            if (scene.type === 'choice') {
                nextBtn.style.display = 'none';
                scene.choices.forEach((choice, index) => {
                    const button = document.createElement('button');
                    button.className = 'choice-btn';
                    button.textContent = choice.text;
                    button.onclick = () => selectChoice(choice.next);
                    choices.appendChild(button);
                });
            } else if (scene.type === 'random_companion') {
                // ランダム同行者選択
                selectRandomCompanion();
                return;
            } else if (scene.type === 'ending') {
                nextBtn.style.display = 'none';
                
                // ハッピーエンドでない場合のみエピローグボタンを表示
                if (!scene.isHappyScene) {
                    const epilogueBtn = document.createElement('button');
                    epilogueBtn.className = 'choice-btn';
                    epilogueBtn.textContent = 'エピローグを見る';
                    epilogueBtn.onclick = () => showEpilogue();
                    choices.appendChild(epilogueBtn);
                }
                
                const titleBtn = document.createElement('button');
                titleBtn.className = 'choice-btn';
                titleBtn.textContent = 'タイトルに戻る';
                titleBtn.onclick = () => location.reload();
                choices.appendChild(titleBtn);
            } else {
                nextBtn.style.display = 'block';
            }
        }

        function nextScene() {
            currentIndex++;
            if (currentIndex >= currentSceneData.length) {
                return;
            }
            showScene();
        }

        function selectChoice(nextSceneKey) {
            if (allScenes[nextSceneKey]) {
                currentSceneData = allScenes[nextSceneKey];
                currentIndex = 0;
                showScene();
            }
        }

        function selectRandomCompanion() {
            // 握力の確率を低く設定（10%）、他は各15%
            const random = Math.random();
            let selectedEnding;
            
            if (random < 0.1) {
                selectedEnding = 'happy_ending';
            } else if (random < 0.25) {
                selectedEnding = 'o_ketsugo_end';
            } else if (random < 0.4) {
                selectedEnding = 'maq_end';
            } else if (random < 0.55) {
                selectedEnding = 'o_mura_end';
            } else if (random < 0.7) {
                selectedEnding = 'o_zou_end';
            } else if (random < 0.85) {
                selectedEnding = 'k_yama_end';
            } else {
                selectedEnding = 'do_y_end';
            }
            
            currentSceneData = allScenes[selectedEnding];
            currentIndex = 0;
            showScene();
        }

        function showEpilogue() {
            currentSceneData = allScenes.epilogue;
            currentIndex = 0;
            showScene();
        }
    </script>
</body>
</html>
